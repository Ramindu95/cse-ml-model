INFO: package: mysql.connector.plugins
INFO: plugin_name: caching_sha2_password
INFO: AUTHENTICATION_PLUGIN_CLASS: MySQLCachingSHA2PasswordAuthPlugin
INFO: 🔄 Starting feature engineering...
INFO: 💰 Merging financial data with stock data...
INFO: ✅ Merged data shape: (854, 44)
INFO: DataFrame index reset and name removed for consistency.
INFO: DataFrame resorted and index re-reset to ensure consistent order.
INFO: 📈 Adding technical indicators...
WARNING: Not enough data for ATR calculation for company_id 1. Expected at least 14 rows, got 1. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 2. Expected at least 14 rows, got 1. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 3. Expected at least 14 rows, got 4. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 4. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 6. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 8. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 9. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 10. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 13. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 14. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 16. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 18. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 19. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 20. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 21. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 22. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 23. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 24. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 25. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 26. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 30. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 31. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 32. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 33. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 34. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 35. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 37. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 40. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 43. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 44. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 45. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 46. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 48. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 49. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 53. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 54. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 55. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 56. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 58. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 59. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 60. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 61. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 62. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 63. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 64. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 65. Expected at least 14 rows, got 1. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 66. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 67. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 68. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 69. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 70. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 71. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 72. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 73. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 74. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 76. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 78. Expected at least 14 rows, got 2. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 79. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 81. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 82. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 83. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 84. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 85. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 86. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 89. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 90. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 91. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 92. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 93. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 95. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 96. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 97. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 98. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 100. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 101. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 102. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 103. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 104. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 105. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 106. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 107. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 108. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 111. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 112. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 113. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 115. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 116. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 117. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 118. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 119. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 120. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 121. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 122. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 123. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 124. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 125. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 126. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 127. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 128. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 129. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 132. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 133. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 135. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 139. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 140. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 141. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 142. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 143. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 145. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 146. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 147. Expected at least 14 rows, got 1. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 148. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 149. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 150. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 151. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 152. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 153. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 154. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 155. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 156. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 157. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 158. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 159. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 160. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 162. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 163. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 164. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 166. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 167. Expected at least 14 rows, got 2. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 168. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 170. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 171. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 172. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 175. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 176. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 177. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 178. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 179. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 180. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 182. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 183. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 184. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 185. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 186. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 187. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 189. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 190. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 192. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 193. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 195. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 196. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 198. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 199. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 200. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 201. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 202. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 203. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 204. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 205. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 206. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 207. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 208. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 209. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 210. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 211. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 212. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 215. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 216. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 217. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 218. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 220. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 221. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 222. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 223. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 224. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 225. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 226. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 227. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 228. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 229. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 231. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 232. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 234. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 235. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 241. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 243. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 245. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 246. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 247. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 250. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 251. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 252. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 255. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 256. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 257. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 258. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 259. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 262. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 265. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 266. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 267. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 268. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 271. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 272. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 274. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 275. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 276. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 277. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 279. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 280. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 281. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 282. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 283. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 284. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 285. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 286. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 288. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 289. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 290. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 291. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 293. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 295. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 296. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 299. Expected at least 14 rows, got 1. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 301. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 302. Expected at least 14 rows, got 2. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 303. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 304. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 306. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 307. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 308. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 309. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 311. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 314. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 315. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 316. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 317. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 318. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 319. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 321. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 325. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 326. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 327. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 328. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 329. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 330. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 331. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 333. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 335. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 336. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 337. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 338. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 339. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 340. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 341. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 342. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 346. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 347. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 348. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 349. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 350. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 351. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 353. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 355. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 356. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 357. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 359. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 360. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 361. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 362. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 363. Expected at least 14 rows, got 2. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 364. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 365. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 366. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 367. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 368. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 369. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 370. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 371. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 372. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 373. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 374. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 375. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 376. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 377. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 378. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 379. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 380. Expected at least 14 rows, got 3. Filling with NaN.
WARNING: Not enough data for ATR calculation for company_id 381. Expected at least 14 rows, got 3. Filling with NaN.
INFO: 💰 Adding fundamental indicators...
INFO: 🧹 Cleaning and validating features...
INFO: 🧹 Cleaning and validating features...
INFO: ✅ Cleaned and validated features. Shape changed from (854, 102) to (854, 102)
INFO: 🎯 Creating target labels for training...
INFO: Labels created. Label distribution: {0: 181, 1: 465, 2: 208}
INFO: ✅ Feature engineering complete for training!
INFO:    📊 Technical features: 35
INFO:    💼 Fundamental features: 51
INFO:    🔢 Total features (dynamically selected): 86
INFO: 📋 Final dataset summary for training:
INFO:    🔢 Samples: 854
INFO:    📊 Features: 86
INFO:    🏷️ Label distribution: {0: 181, 1: 465, 2: 208}
INFO: 💾 Training features saved to: models/training_features.json
🚀 Starting Stock Prediction Model Training
============================================================

📊 Loading data...
✅ Loaded stock data: 854 records for 289 companies
✅ Loaded financial data: 6 records for 2 companies
✅ Loaded stock data: 854 records
✅ Companies with stock data: 289
✅ Loaded financial data: 6 records
✅ Companies with financial data: 2

🔧 Engineering features...
💾 Feature information saved to: results/feature_info.txt
💾 Training features list saved to: models/training_features.json

📊 Splitting dataset...
Training set: 683 samples
Test set: 171 samples
Train labels: {0: 145, 1: 372, 2: 166}
Test labels: {0: 36, 1: 93, 2: 42}

🤖 Training models...

🔄 Training random_forest...
   ⚖️ Class weights: {np.int64(0): np.float64(1.5701149425287357), np.int64(1): np.float64(0.6120071684587813), np.int64(2): np.float64(1.3714859437751004)}
   🔍 Performing hyperparameter tuning for random_forest...
   ✅ Best parameters: {'max_depth': 20, 'max_features': 'log2', 'min_samples_leaf': 2, 'min_samples_split': 2, 'n_estimators': 100}
   ✅ Best CV F1 score: 0.6437

============================================================
EVALUATION RESULTS FOR RANDOM_FOREST
============================================================
Accuracy: 0.5205
F1 Score (weighted): 0.5408

Classification Report:
              precision    recall  f1-score   support

        Sell       0.26      0.31      0.28        36
        Hold       0.84      0.71      0.77        93
         Buy       0.24      0.29      0.26        42

    accuracy                           0.52       171
   macro avg       0.45      0.43      0.44       171
weighted avg       0.57      0.52      0.54       171


Confusion Matrix:
[[11  4 21]
 [11 66 16]
 [21  9 12]]

Top 15 Most Important Features:
           feature  importance
  price_volatility    0.124966
price_acceleration    0.064782
   volatility_rank    0.059268
         hl_spread    0.054862
               OBV    0.053978
 intraday_momentum    0.048992
      volume_MA_20    0.048572
              VWAP    0.046694
            EMA_26    0.044858
       opening_gap    0.044153
             MA_50    0.043579
             MA_10    0.042962
              MA_5    0.041498
            EMA_12    0.040837
      volume_ratio    0.040077
💾 Feature importance saved to: results/random_forest_feature_importance.csv
   💾 Model saved to: models/random_forest_model.pkl

🔄 Training gradient_boosting...
   ⚖️ Class weights: {np.int64(0): np.float64(1.5701149425287357), np.int64(1): np.float64(0.6120071684587813), np.int64(2): np.float64(1.3714859437751004)}
   🔍 Performing hyperparameter tuning for gradient_boosting...
   ✅ Best parameters: {'learning_rate': 0.1, 'max_depth': 5, 'min_samples_split': 2, 'n_estimators': 200}
   ✅ Best CV F1 score: 0.5983

============================================================
EVALUATION RESULTS FOR GRADIENT_BOOSTING
============================================================
Accuracy: 0.6316
F1 Score (weighted): 0.6159

Classification Report:
              precision    recall  f1-score   support

        Sell       0.47      0.39      0.42        36
        Hold       0.75      0.86      0.80        93
         Buy       0.40      0.33      0.36        42

    accuracy                           0.63       171
   macro avg       0.54      0.53      0.53       171
weighted avg       0.61      0.63      0.62       171


Confusion Matrix:
[[14 10 12]
 [ 4 80  9]
 [12 16 14]]

Top 15 Most Important Features:
          feature  importance
 price_volatility    0.265175
     volume_MA_20    0.112673
        hl_spread    0.106952
              OBV    0.088900
intraday_momentum    0.087809
      opening_gap    0.042538
             VWAP    0.042042
volume_change_pct    0.031380
     volume_ratio    0.029758
              PVT    0.025168
            MA_50    0.024792
             MA_5    0.022976
           EMA_12    0.022160
            MA_20    0.020350
     daily_return    0.015335
💾 Feature importance saved to: results/gradient_boosting_feature_importance.csv
   💾 Model saved to: models/gradient_boosting_model.pkl

🔄 Training logistic_regression...
   🔄 Scaling features for logistic_regression...
   💾 Scaler saved to: scalers/logistic_regression_scaler.pkl
   ⚖️ Class weights: {np.int64(0): np.float64(1.5701149425287357), np.int64(1): np.float64(0.6120071684587813), np.int64(2): np.float64(1.3714859437751004)}
   🔍 Performing hyperparameter tuning for logistic_regression...
   ✅ Best parameters: {'C': 0.1, 'penalty': 'l2', 'solver': 'liblinear'}
   ✅ Best CV F1 score: 0.5957

============================================================
EVALUATION RESULTS FOR LOGISTIC_REGRESSION
============================================================
Accuracy: 0.5731
F1 Score (weighted): 0.5984

Classification Report:
              precision    recall  f1-score   support

        Sell       0.38      0.33      0.35        36
        Hold       0.92      0.66      0.77        93
         Buy       0.34      0.60      0.43        42

    accuracy                           0.57       171
   macro avg       0.55      0.53      0.52       171
weighted avg       0.67      0.57      0.60       171


Confusion Matrix:
[[12  1 23]
 [ 7 61 25]
 [13  4 25]]
   💾 Model saved to: models/logistic_regression_model.pkl

📈 Comparing models...

================================================================================
MODEL COMPARISON SUMMARY
================================================================================
              Model CV F1 Score Test Accuracy Test F1 Score
  gradient_boosting      0.5983        0.6316        0.6159
logistic_regression      0.5957        0.5731        0.5984
      random_forest      0.6437        0.5205        0.5408

💾 Model comparison saved to: results/model_comparison.csv

🏆 Best performing model: gradient_boosting
🎯 Test F1 Score: 0.6159
🎯 Test Accuracy: 0.6316

💾 Saving training summary...
💾 Training summary saved to: results/training_summary.txt

🎉 Training Complete!
📁 Results saved in: results/
📁 Models saved in: models/
🏆 Best model: gradient_boosting
📊 Use 'gradient_boosting_model.pkl' for predictions
